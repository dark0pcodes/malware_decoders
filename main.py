"""
Authos: Felipe Duarte

Decrypting REMCOS RAT configuration

For this to work, you need to manually extract the SETTINGS data from the RAT's resources usign Resource Hacker or
any other tool, then use this tool to decrypt its contents.
"""
import arc4


def load_file(file_path):
    with open(file_path, 'rb') as f:
        data = f.read()
    return data


if __name__ == '__main__':
    res = load_file('SETTINGS.bin')
    key_len = res[0]

    key = res[1: 1 + key_len]
    rc4 = arc4.ARC4(key)

    plain_text = rc4.decrypt(res[1 + key_len:])
    print(plain_text)

